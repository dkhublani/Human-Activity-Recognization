---
title: "KNN"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Loading of Training Data Set and Testing Data Set

```{r}
library(class)
library(readr)
X_train <- read_delim("X_train.txt", 
                      "\t", escape_double = FALSE, trim_ws = TRUE)

y_train <- read_csv("y_train.txt")
y_train$Y1<-as.factor(y_train$Y1)

X_test <- read_delim("X_test.txt", 
                     "\t", escape_double = FALSE, trim_ws = TRUE)

y_test <- read_csv("y_test.txt")
y_test$Y<-as.factor(y_test$Y)

Train<-data.frame(y_train,X_train)


```

Loading traing and testing data sets obtained after dimension reduction using PCA

```{r}
library(class)
library(readr)

PCA_train_10 <- read_csv("PCA.10.csv")
PCA_train_10<-PCA_train_10[,3:12]
PCA_train_10<-data.frame(y_train,PCA_train_10)

PCA_train_40 <- read_csv("PCA.40.csv")
PCA_train_40<-PCA_train_40[,3:42]
PCA_train_40<-data.frame(y_train,PCA_train_40)


PCA_train_63 <- read_csv("PCA.63.csv")
PCA_train_63<-PCA_train_63[,3:65]
PCA_train_63<-data.frame(y_train,PCA_train_63)

PCA_test_10 <- read_csv("PCA_test.10.csv")
PCA_test_10<-PCA_test_10[,3:12]

PCA_test_40 <- read_csv("PCA_test.40.csv")
PCA_test_40<-PCA_test_40[,3:42]

PCA_test_63 <- read_csv("PCA_test.63.csv")
PCA_test_63<-PCA_test_63[,3:65]
```

Applying knn method to find best k for repective models using Cross-Validation error

```{r}
library(caret)
ctrl <- trainControl(method="cv",number = 10 )  
knn.PCA.10<-train(Y1~.,data=PCA_train_10,trControl=ctrl,method="knn")
print(knn.PCA.10)
temp<-predict(knn.PCA.10,newdata = PCA_test_10)
table(temp,y_test$Y)
error_rate.knn.PCA.10<-mean(temp != y_test$Y)
error_rate.knn.PCA.10
```
```{r}
knn.PCA.40<-train(Y1~.,data=PCA_train_40,trControl=ctrl,method="knn")
print(knn.PCA.40)
temp<-predict(knn.PCA.40,newdata = PCA_test_40)
table(temp,y_test$Y)
error_rate.knn.PCA.40<-mean(temp != y_test$Y)
error_rate.knn.PCA.40
```
```{r}
knn.PCA.63<-train(Y1~.,data=PCA_train_63,trControl=ctrl,method="knn")
print(knn.PCA.63)
temp<-predict(knn.PCA.63,newdata = PCA_test_63)
table(temp,y_test$Y)
error_rate.knn.PCA.63<-mean(temp != y_test$Y)
error_rate.knn.PCA.63

```

Lodaing training and testing data set obtained after best subset selection of variables using Random Forest

```{r}
library(MASS)
library(readr)
subset_train <- read_csv("subset_train.csv")
subset_train<-subset_train[,2:38]
subset_train$Y1<-factor(subset_train$Y1)
subset_test<- read_csv("subset_test.csv")
subset_test<-subset_test[,3:38]
```

Using knn Models and getting Cross Validated error to fid best k and best model
```{r}
knn.subset<-train(Y1~.,data=subset_train,trControl=ctrl,method="knn")
print(knn.subset)
temp<-predict(knn.subset,newdata = subset_test)
table(temp,y_test$Y)
error_rate.knn.subset<-mean(temp != y_test$Y)
error_rate.knn.subset

```




